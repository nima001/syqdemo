import request from '@/framework/utils/request'
import { v4 as uuidv4 } from 'uuid'
import { setCookie,getCookie} from '@/framework/utils/auth'
// 登录(票据)
export function loginByTicket (ticket) {
  return request({
    url: '/auth/v2/loginByTicket',
    method: 'post',
    data: {
      ticket
    },
  });
}

// 登录(账号和密码登录)
export function loginByPwd (data) {
  return request({
    url: '/auth/v2/login',
    method: 'post',
    data
  })
}

// 登出
export function logout () {
  return request({
    url: '/auth/v1/logout',
    method: 'post',
  });
}

// 登录 (新版本)
export function login (data) {
  return request({
    url: '/sso/v2/sso/login',
    method: 'post',
    data
  })
}

// 登出（政府网）
export function logoutZfw () {
  return request({
    url: '/idmgzmh/index/logout',
    method: 'post',
  });
}

// 获取RSA加密公钥
export function getPublicKey () {
  return request({
    url: '/base/base/getPublickey',
    method: 'post'
  })
}

/**
 *  获取验证码
 *  verifyModel 
 *    1:登录相关,2:密码相关,3:用户注册,4:用户认证等级提升,5:账户激活,6:账户注销,99:其他
 */
export function getCode(verifyModel){
  let uuid = getCookie('uuid');
  if(!uuid){
      uuid = uuidv4().split('-').join('');
      setCookie('uuid',uuid)
  }
  return `http://192.168.1.87:8080/base/base/verifyimg/${verifyModel}/${uuid}?`;
}

// 判断是否需要验证码
export function isNeedCode(){
  return request({
    url:'/sso/v2/sso/isNeedImgcode',
    method:'post'
  })
}


// 账号相关 - 重置密码-账号确认（步骤一)

export function resetpwdFinduser(data){
  return request({
    url:'/idm/v2/account/resetpwdFinduser',
    method:'post',
    data
  })
}
// http://192.168.1.87:10070/v2/account/resetpwdFinduser