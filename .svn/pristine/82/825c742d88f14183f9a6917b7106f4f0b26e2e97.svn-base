<template>
  <div class="distrist-map" ref="contaner">
    <a class="distrist" @click="onBack">{{distrist.title}}</a>
    <component :is="areaComponent" @click="onAreaClick" :style="mapStyle"/>
    <!-- <Map330100 :style="{
      position: 'absolute',
      top: 0,
      display: display
    }"/> -->
  </div>
</template>
<script>
import Map330000 from '../map/Map330000'
import Map330100 from '../map/Map330100'
import Map330200 from '../map/Map330200'
import Map330300 from '../map/Map330300'
import Map330400 from '../map/Map330400'
import Map330500 from '../map/Map330500'
import Map330600 from '../map/Map330600'
import Map330700 from '../map/Map330700'
import Map330800 from '../map/Map330800'
import Map330900 from '../map/Map330900'
import Map331000 from '../map/Map331000'
import Map331100 from '../map/Map331100'

export default {
  components: {
    Map330000,
    Map330100,
    Map330200,
    Map330300,
    Map330400,
    Map330500,
    Map330600,
    Map330700,
    Map330800,
    Map330900,
    Map331000,
    Map331100,
  },
  data(){
    return {
      mapStyle: {},
      distrist: { adcode : '330000', title: '浙江省'},
    }
  },
  created(){

  },
  computed: {
    areaComponent(){
      return 'Map' + this.distrist.adcode;
    },
  },
  methods: {
    onBack(){
      if(this.distrist.adcode != '330000'){
        this.distrist = { adcode : '330000', title: '浙江省'};
      }
    },
    onAreaClick({ adcode, title, elem, event }){
      if(this.distrist.adcode == '330000'){
        const contaner = this.$refs.contaner;
        const cRect = contaner.getBoundingClientRect();
        const rect = elem.getBoundingClientRect();
        const offsetX = cRect.x + cRect.width/2 - (rect.x + rect.width/2), offsetY = cRect.y + cRect.height/2 - (rect.y + rect.height/2);
        const scale = Math.min(cRect.width/rect.width, cRect.height/rect.height);
        this.fadeIn = false;
        this.mapStyle = {
          transform: `scale(${scale}) translate(${offsetX}px, ${offsetY}px)`,
          // opacity: .4,
        }
        setTimeout(() => {
          this.distrist = { adcode, title };
          this.mapStyle = {};
        }, 500)
      }else{
        console.log('select', title);
      }
    },
  }
}
</script>
<style lang="less" scoped>
@keyframes areaBoundaryfadeIn{
  0% { opacity: 0; }
  100% { opacity: 1; }
}
.distrist-map{
  height: 450px;
  position: relative;
  overflow: hidden;
  .distrist{
    position: absolute;
    top: 0;
    color: #fff;
  }
  /deep/svg{
    width: 100%;
    height: 100%;
    transition: all .5s cubic-bezier(0.075, 0.82, 0.165, 1);
    & > g, & > text{
      animation: areaBoundaryfadeIn .5s linear 1,
    }
  }
}
</style>