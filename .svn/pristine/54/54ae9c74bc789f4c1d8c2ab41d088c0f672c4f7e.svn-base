
<template>
  <div class="form-panel">
    <div class="form-body" ref="formBody">
      <template v-for="item in itemList">
        <div class="title-bar" v-if="typeof(item.key) == 'number'" :key="item.sort">{{item.sort}}</div>
        <component v-else :is="item.key" :key="item.key" :data="content[item.key]" />
      </template>
    </div>
    <a-anchor v-if="titleList && titleList.length > 1" wrapperClass="form-anchor" :getContainer="() => $refs.formBody">
      <a-anchor-link v-for="item in titleList" :href="`#${item.key}`" :title="item.sort" :key="item.key"/>
    </a-anchor>
  </div>
</template>
<script>
import { Anchor } from "ant-design-vue";
import { getComponents, getItems } from './contentItems';

//评估内容
export default {
  components: {
    AAnchor: Anchor,
    AAnchorLink: Anchor.Link,
    ...getComponents()
  },
  props: {
    content: Object,//分析内容
  },
  data(){
    return {
      
    }
  },
  created(){

  },
  computed: {
    itemList(){
      if(this.content){
        let arr = [], index = 0, sort;
        getItems(this.content).forEach(item => {
          if(item.sort && sort !== item.sort){
            arr.push({key: ++index, sort: item.sort})
            sort = item.sort;
          }
          arr.push(item);
        })
        return arr;
      }
    },
    titleList(){
      if(this.itemList){
        return this.itemList.filter(item => typeof(item.key) == "number")
      }
    }
  },
  methods: {

  }
}
</script>
<style lang="less" scoped>
.form-panel{
  position: relative;
  height: 100%;
  .form-body {
    height: 100%;
    padding: 0 @content-padding-h;
    overflow-y: auto;
    padding-right: 200px + @content-padding-h;

    .title-bar{
      margin: 10px 0;
      line-height: 1em;
      border-left: 5px solid @primary-color;
      font-size: 18px;
      text-indent: 5px;
      color: @primary-color;
    }
  }
  /deep/.form-anchor {
    position: absolute;
    top: 50px;
    right: @content-padding-h;
    width: 180px;
    padding-left: 5px;
  }
}
</style>