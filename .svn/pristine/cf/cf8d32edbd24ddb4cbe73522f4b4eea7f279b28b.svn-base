<template>
  <ul>
    <li v-for="(item, index) in value" :key="index">
      <div class="tag">
        {{getText(item)}}
        <a-icon v-if="deleteable" type="close" class="remove" @click="onRemoveTag(item, index)"/>
      </div>
    </li>
  </ul>
</template>
<script>
import { Icon } from 'ant-design-vue'
import get from 'lodash/get';

/**
 * 标签列表
 * 提供事件 remove 删除标签是响应，
 */
export default {
  components: {
    AIcon: Icon
  },
  props: {
    value: {//列表
      type: Array,
      default: () => []
    },
    text: [String, Function], //显示文本 String 对象的key 序列化方法//TODO 支持solt
    deleteable: {
      type: Boolean,
      default: true,
    }
  },
  methods: {
    getText(item){
      if(this.text){
        if(typeof(this.text) == 'function'){
          return this.text(item);
        }else{
          return get(item, this.text);
        } 
      }
      return item;
    },
    onRemoveTag(item, index){
      this.value.splice(index, 1);
      this.$emit('input', this.value);
      this.$emit('remove', item);
    }
  }
}
</script>
<style lang="less" scoped>
ul{
  margin: 0;
  overflow: hidden;
}
li{
  float: left;
  padding: 4px;
  max-width: 100%;
  .tag{
    position: relative;
    padding: 6px 12px 6px 8px;
    line-height: 1.4em;
    background: #e8e8e8;
    border-radius: @border-radius-base;
    cursor: pointer;
    // overflow: hidden;
    // white-space: nowrap;
    // text-overflow: ellipsis;
    i{
      position: absolute;
      right: 0;
      top: 0;
      font-size: 10px;
      padding: 1px 1px 3px 3px;
      border-top-right-radius: @border-radius-base;
      border-bottom-left-radius: 10px;
      // background: rgba(#d3d2d2, 0.6);
    }
    & i:hover{
      color: @error-color;
    }
  }
}
</style>